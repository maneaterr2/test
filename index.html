<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Калькулятор</title>
   

  </head>
  <style>
    .calc_div{
        width: calc(100% - 30px);
        max-width:800px;
        border-radius:6px;
        box-shadow: 3px 0px 25px rgba(0, 0, 0, 0.25);
        margin:20px auto;
        padding:15px;
        min-height: 440px;
        position:relative;
    }
    .calc_label{
        display:block;
        margin-bottom:10px;
        background: #FFFFFF;
        box-shadow: 0px 1px 6px rgba(0, 0, 0, 0.25);
        border-radius: 6px;
        min-height: 40px;
        
    }
    .calc_label_active{
        background: #0188CC !important;
        color:#fff;
        box-shadow: inset 0px 4px 4px rgba(0, 0, 0, 0.25) !important;
    }
    .calc_label:hover{
        display:block;
        margin-bottom:10px;
        cursor:pointer;
        color:#fff;
        background-color:#0188CC;
    }
    .state_dad{
        display:flex;
        justify-content:space-around;
        flex-wrap: nowrap;
    }
    .state_done{
        background-color:#003955 !important;
    }
    .state{
        margin:2px;
        height:10px;
        width:20%;
        background-color:#ccc;
    }
    .next_btn{
        padding:10px 20px;
        color:#fff;
        background-color:#2D343C;
        border:none;
        border-radius:6px;
        outline:none;
        cursor:pointer;
    }
    .action_btn{
        padding:15px 25px;
        color:#fff;
        background-color:#003955;
        font-size:30px;
        border:none;
        border-radius:30px;
        outline:none;
        cursor:pointer;
        animation-name: action_btn;
        animation-duration: 1s;
        animation-fill-mode: both;
        animation-iteration-count:infinite;
    }
    h4{
        font-size:20px;
        text-align:center;
    }
    .calc_label input{
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
    }
    .calc_label>span{
        font-size:18px;
        padding:11px 20px;
        display:block;
    }
    .calc_form{
        width:74%;
        margin:10px 10%;
        border-radius: 6px;
        border:none;
        outline:none;
        padding:10px;
    }
    .action_btn:hover{
        animation:none;
    }
    @keyframes action_btn {
        0% {
        
        transform: scale(1);
        }
        50%{
            transform: scale(1.2);
        }
        100% {
        /* transform: translateY(100%); */
            transform: scale(1);
        }
    } 
    .next-enter-active,.next-leave-active,.prev-enter-active,.prev-leave-active {
    transition: all .2s ease;
    }
    .next-leave-to
    {
    /* transform: translateX(-100vw); */
    transform: scale(0.8);
    opacity:0;
    }
    .next-enter
    {
    /* transform: translateX(1000px); */
    transform: scale(1.1);
    }
    .prev-leave-to{
    /* transform: translateX(100vw); */
    transform: scale(1.1);
    opacity:0;
    }
    .prev-enter{
    /* transform: translateX(-1000px); */
    transform: scale(0.8);
    }


  </style>
  <body>  	
	<main id="app">
        <div class="calc_div">
            <div style="margin:20px auto;width:100%;border-radius:6px;height: 10px;background-color: #ccc;position:relative">
                <div :style="{'border-radius':progress_border,'height':'10px','background':'#003955','width':progress_width/10+'%'}">
                </div>
                <template v-for="n in 11">
                    <div :style="{'width':'4px','background':'#fff','height':'10px','position':'absolute','top':'0','left':n*8.3+'%'}"></div>
                </template>
            </div>
            <transition :name="transition" mode="out-in">
                <template v-for="item in data">
                    <div v-if="active==item.key" :key="item.key">
                       
                        <h4>{{item.title}}</h4>
                        <h3 v-show="error" align="center" style="color:red">Вы ничего не выбрали</h3>
                            <template v-if="active<3">
                                <template v-for="(dot,index) in item.fields">
                                    <label :class="[(item.value.indexOf(index)>=0)?'calc_label_active':'','calc_label']">
                                        <input type="checkbox" :value="index" v-model="item.value">
                                        <span>{{dot}}</span>
                                    </label>
                                </template>
                                <span>*Можно выбрать несколько пунктов</span>
                            </template>
                            <template v-if="active>2">
                                <template v-if="active==9">
                                    <div style="display:flex;flex-wrap:wrap; justify-content: space-around;">
                                        <template v-for="(dot,index) in item.fields">
                                            <label :class="[(item.value===index)?'calc_label_active':'','calc_label']" style="width:100%;max-width: 350px;">
                                                <input type="radio" :value="index" v-model="item.value">
                                                <span>{{dot}}</span>
                                            </label>
                                        </template>
                                    </div>
                                </template>
                                <template v-else>
                                    <template v-for="(dot,index) in item.fields">
                                        <label :class="[(item.value===index)?'calc_label_active':'','calc_label']">
                                            <input type="radio" :value="index" v-model="item.value">
                                            <span>{{dot}}</span>
                                        </label>
                                    </template>

                                </template>
                                                    
                            </template>
                            
                            <div style="padding-top: 10px;">** Базовый комплект</div>
                    </div>
                </template>
            </transition>
            <div style="width:100%;height:60px"></div>
            <div style="text-align:center;margin:20px auto;position:absolute;width:100%;left:0;bottom:0">
                <button v-if="active>1"class="next_btn" @click="prev_block">Назад</button>
                <button v-if="active!=12"class="next_btn" @click="next_block">Далее</button>
            </div>
        </div>
            <template>
                <div class="calc_div" v-if="active">  
                    <div style="margin:20px auto;width:100%;border-radius:6px;height: 10px;background-color: #ccc;position:relative">
                        <div :style="{'border-radius':progress_border,'height':'10px','background':'#003955','width':progress_width/10+'%'}">
                        </div>
                        <template v-for="n in 11">
                            <div :style="{'width':'4px','background':'#fff','height':'10px','position':'absolute','top':'0','left':n*8.3+'%'}"></div>
                        </template>
                    </div>
                    <div style="width:100%;display:flex;flex-wrap:wrap;justify-content: space-around;margin-top:40px">
                        <div style="width:100%; max-width: 350px;padding:30px 15px">
                            <div style="text-align: center; font-size: 20px;margin-bottom: 20px;">
                                Рассчётная<br>
                                стоимость<br>
                                аккредитации
                            </div>
                            <div style="text-align: center; font-size: 70px;">
                                {{calculator}}
                            </div>
                            <div style="text-align: center; font-size: 30px;">
                                рублей
                            </div>
                            <button style="width:80%;margin:20px 10%;padding:10px;background: #2D343C;color:#fff;border:none;border-radius: 6px;" @click="clear">ПЕРЕСЧИТАТЬ</button>
                        </div>
                        <div style="width:100%; max-width: 350px;background:#2D343C;padding:30px 15px;border-radius: 6px;">
                            <div style="text-align: center; font-size: 30px;color:#fff">
                                Отправить заявку
                            </div>
                            <input type="text" class="calc_form" placeholder="Ваше имя">
                            <input type="text" class="calc_form" placeholder="Ваш e-mail">
                            <input type="text" class="calc_form" placeholder="Ваш телефон">
                            <button style="width:80%;margin:20px 10%;padding:10px;background: #ECB322;color:#333;border:none;border-radius: 6px;">ОТПРАВИТЬ</button>
                        </div>
                    </div>

                </div>
                <div class="calc_div">
                    <h4>Здравствуйте!</h4>
                    <p>
                        <span style="margin-left:30px"></span> В соответствии с вашим запросом на подготовку <b>{{text_for_email(1)}}</b> аккредитации в системе <b>{{text_for_email(0)}}</b> стоимость информационно-консультационных услуг с последующим сопровождением на всех этапах («под ключ») составит {{calculator}} рублей (без НДС).
                    </p>
                    <p style="margin-top: 30px;">
                        <span>Комплекс работ включает в себя:</span><br><br>
                        1. Первичный аудит лаборатории:<br>
                        <ul>
                            <li>
                                <span>анализ желаемой области аккредитации (используемых методик и стандартов);</span>
                            </li>
                            <li>
                                <span v-if="data[6].value===1">составление перечня необходимого оборудования и материалов в соответствии с областью аккредитации и требованиям критериев</span>
                                <span v-if="data[6].value===2">подбор необходимого оборудования и материалов в соответствии с областью аккредитации и требованиям критериев</span>
                                <span v-if="data[6].value===0">анализ оборудования и материалов на соответствие области аккредитации и требованиям критериев</span>
                                <span v-if="data[6].value===3">анализ материальной базы на соответствие области аккредитации и требованиям критериев</span>
                            </li>
                            <li>
                                <span v-if="data[2].value===1||data[2].value===2">анализ квалификационного состава персонала на соответствие области аккредитации и требованиям критериев</span>
                                <span v-if="data[2].value===0">определение необходимого квалификационного состава персонала в соответствии с областью аккредитации и требований критериев</span>
                                <span v-if="data[2].value===3">подбор персонала в соответствии с областью аккредитации и требований критериев</span>
                            </li>
                            <li>
                                <span v-if="data[5].value===1||data[5].value===2">анализ лабораторных помещений на соответствие области аккредитации и требований критериев</span>
                                <span v-if="data[5].value===0">анализ лабораторного помещения на соответствие области аккредитации и требований критериев</span>
                                <span v-if="data[5].value===3">анализ помещения и передвижной лаборатории на соответствие области аккредитации и требований критериев</span>
                            </li>
                        </ul>
                        2. Разработка полного пакета документов необходимых для аккредитации;<br>
                        <template v-if="data[9].value===1||data[9].value===2">3. Внедрение разработанной системы менеджмента качества и проведение подготовительных выездных аудитов<br>4. </template>
                        <template v-if="data[9].value===0">3. Внедрение разработанной системы менеджмента качества и проведение подготовительного выездного аудита<br>4. </template>
                        <template v-if="data[9].value===3">3. </template>
                        Сопровождение на всех этапах и отработка возникающих вопросов и замечаний, связанных с процессом аккредитации:
                        <ul>
                            <li>Формирование пакета документов для подачи и мониторинг заявки;</li>
                            <li>Устранение замечаний, выявленных при проведении документарной и выездной экспертизы;</li>
                            <li>Консультационное сопровождение на всех этапах.</li>
                        </ul>
                        В случае вашего положительного решения базовые условия договора подразумевают поэтапную оплату услуг:<br>
                        <span style="margin-left: 20px;">1.	Разработка документации и подготовка к подаче – 30%;</span><br>
                        <span style="margin-left: 20px;">2.	Завершение документарной экспертизы – 40%;</span><br>
                        <span style="margin-left: 20px;">3.	Завершение выездной экспертизы – 30%.</span><br>
                    </p>
                </div>
            </template>
       
	</main>

  </body>
  <script src="vue.js"></script>
  <script>
     
    const app = new Vue({
    el: '#app',
    data(){
        return{
            active:1,
            error:false,
            transition:"next",
            progress_width:0,
            progress_border:"6px 0 0 6px",
            data:[
                {key:1,title:"1.Система аккредитации:",value:[],fields:['Национальная система аккредитации (ФСА «Росаккредитация»)','Система аккредитации в области использования атомной энергии (ГК "Росатом")','Международная система аккредитации ILAC (АЦЦ «Аналитика»)']},
                {key:2,title:"2.Интересующий тип аккредитации:",value:[],fields:['Аккредитация Органа по сертификации','Аккредитация Лаборатории (испытательного центра) **','Аккредитация Органа инспекции','Другой вид аккредитации']},
                {key:3,title:"3.Наличие обученных специалистов с подтвержденным опытом более 3 лет",value:"",fields:['Нет','1-2 **','3 и более','Нужно подобрать']},
                {key:4,title:"4.Планируемая численность специалистов, работающих в соответствующей области аккредитации",value:"",fields:['До 5 **','До 10','До 30','Свыше 30']},
                {key:5,title:"5.Количество документов, устанавливающих правила и методы исследований (испытаний), измерений",value:"",fields:['До 5 **','До 10','До 30','Свыше 30']},
                {key:6,title:"6.Количество мест осуществления деятельности (филиалов лаборатории)",value:"",fields:['1 **','2','3','Передвижная лаборатория']},
                {key:7,title:"7.Наличие оборудования",value:"",fields:['Есть **','Нет','Требуется подбор','Оборудование не требуется']},
                {key:8,title:"8.Наличие помещений",value:"",fields:['Есть **','Нет','Нужно подобрать']},
                {key:9,title:"9.Выберите свой округ",value:"",fields:['Центральный**','Северо-Западный**','Южный','Северо-Кавказский','Приволжский','Уральский','Сибирский','Дальневосточный']},
                {key:10,title:"10.Количество желаемых выездных аудитов",value:"",fields:['1 **','2','3','Удалённый формат']},
                {key:11,title:"11.Была ли ранее какая-либо аккредитация? (Возможно Вы были аккредитованы в добровольной системе)",value:"",fields:['Да','Нет']},
                {key:12,title:"12. Как срочно вы планируете приступить к аккредитации",value:"",fields:['В течение 2 недель **','В течение месяца **','В течение 3 месяцев **','В течение 1 год другое **']},
            ]
        }
    },
    computed:{
        calculator(){
            let error = false;
            this.data.forEach(function(elem,index){
                if(elem.value===""||elem.value.length==0){
                    error = "Цена";
                }
            })
            if(error){
                return error;
            }else{
                return this.magik()+" 000";
            }
        }
    },
    methods:{
        magik:function(){
            let obj = {
                k1:350,
                k2:0,
                k3:0,
                k4:0,
                k5:0,
                k6:0,
                k7:0,
                k8:0,
                k9:0,
                k10:0,
                k11:0,
                k12:0
            }
            if(this.data[0].value.length>1){
                obj.k1 = 350 + ((this.data[0].value.length - 1)*200);
            }
            if(this.data[1].value.length>1){
                if(this.data[1].value.filter(e=>e===0||e===2).length!=0){
                    obj.k2 = 50 + ((this.data[1].value.length - 1)*200);
                }else{
                    obj.k2 = 200;
                }
            }else if(this.data[1].value[0]===0||this.data[1].value[0]===2){
                obj.k2 = 50;
            }
            
            switch (this.data[2].value) {
                case 0: obj.k3 = 10;break;     
                case 2: obj.k3 = -5;break;   
                case 3: obj.k3 = 20;break; 
                default: obj.k3 = 0;break; 
            }
            //пункт 4
            switch (this.data[3].value) {
                case 1: obj.k4 = 15;break;     
                case 2: obj.k4 = 30;break;   
                case 3: obj.k4 = 50;break; 
                default: obj.k4 = 0;break; 
            }
            //пункт 5 
            switch (this.data[4].value) {
                case 1: obj.k5 = 10;break;     
                case 2: obj.k5 = 20;break;   
                case 3: obj.k5 = 30;break; 
                default: obj.k5 = 0;break; 
            }
            //пункт 6
            switch (this.data[5].value) {
                case 1: obj.k6 = 20;break;     
                case 2: obj.k6 = 30;break;   
                case 3: obj.k6 = 10;break; 
                default: obj.k6 = 0;break; 
            }
            //пункт 7
            switch (this.data[6].value) {
                case 1: obj.k7 = 10;break;  
                case 2: obj.k7 = 25;break; 
                default: obj.k7 = 0;break; 
            }
            //пункт 8
            switch (this.data[7].value) {
                case 1: obj.k8 = 10;break;     
                case 2: obj.k8 = 15;break;   
                default: obj.k8 = 0;break; 
            }
            //пункт 9
            switch (this.data[8].value) {
                case 2: obj.k9 = 5;break;     
                case 3: obj.k9 = 20;break;      
                case 4: obj.k9 = 5;break;      
                case 5: obj.k9 = 5;break;      
                case 6: obj.k9 = 15;break;      
                case 7: obj.k9 = 20;break;   
                default: obj.k9 = 0;break; 
            }
            //пункт 10
            switch (this.data[9].value) {
                case 1: obj.k10 = 25;break;     
                case 2: obj.k10 = 50;break;    
                case 3: obj.k10 = -10;break;   
                default: obj.k10 = 0;break; 
            }
            //пункт 11
            if(this.data[10].value===0){
                obj.k11 = -5;
            }
            //пункт 12
            // switch (this.data[11].value) {
            //     case 0: obj.k12 = -20;break;     
            //     case 1: obj.k12 = -10;break;     
            //     case 3: obj.k12 = 15;break;   
            //     default: obj.k12 = 0;break; 
            // }
            let summ = 0;
            for(key in obj){
                summ +=obj[key];
            }
            return summ;

        },
        next_block:function(){
            if(this.data.find(e=>e.key==this.active).value===""||this.data.find(e=>e.key==this.active).value.length==0){
                this.error = true;
            }else{
                this.error = false;
                this.transition = "next";
                this.active++;
                this.draw_bar(10);
            }
        },
        prev_block:function(){
            this.error = false;
            this.transition = "prev";
            this.active--;
            this.draw_bar(10);
        },
        clear:function(){
            this.data.forEach((elem)=>{
                if(Array.isArray(elem.value)){
                    elem.value.length = 0;
                }else{
                    elem.value ="";
                }
            })
            this.active = 1;
            this.draw_bar(1);
        },
        draw_bar:function(delay){
            if(this.active==13){
                this.progress_border = '6px';
            }else{
                this.progress_border = '6px 0 0 6px';
            }
            let k = this.active - 1;
            let p = 1000/12;
            let position = p*k;
            if(this.progress_width<position){
                let timer = setInterval(() => {
                    if(this.progress_width<position){
                        this.progress_width++
                    }else{
                        clearInterval(timer)
                    }
                }, delay);
            }else{
                let timer = setInterval(() => {
                    if(this.progress_width>position){
                        this.progress_width--
                    }else{
                        clearInterval(timer)
                    }
                }, delay);
            }

        },
        text_for_email:function(val){
            
                if(this.data[val].value.length==1){
                    return this.data[val].fields[this.data[val].value[0]]
                }else if(this.data[val].value.length>1){
                    let text = "";
                    this.data[val].value.forEach((elem,index)=>{
                        if(index===0){
                            text = this.data[val].fields[this.data[val].value[index]]
                        }else{
                            text +=" и "+this.data[val].fields[this.data[val].value[index]]
                        }
                    })
                    return text;
                }else{
                    return "N/A"
                }
           
        }
    }
});

  </script>
</html>
